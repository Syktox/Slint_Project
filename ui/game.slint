import { Button, VerticalBox, HorizontalBox } from "std-widgets.slint";

export component gameView  {
    width: 100%;
    height: 100%;

    //! Properties set from C++
    in property <string> display_word;
    in property <string> status_msg;
    in property <int> mistakes;
    in property <bool> game_won;
    in property <bool> game_over;
    
    // Callbacks to C++
    callback letter_pressed(string);
    callback reset_game();
    callback home_clicked();

    VerticalBox {
        alignment: start;
        spacing: 20px;

        // Visual Hangman
        Rectangle {
            height: 200px;
            background: #34495e;
            border-radius: 8px;
            
            // Gallows Structure
            Rectangle { x: 50px; y: 180px; width: 100px; height: 5px; background: white; } 
            Rectangle { x: 75px; y: 20px; width: 5px; height: 160px; background: white; }  
            Rectangle { x: 75px; y: 20px; width: 60px; height: 5px; background: white; }   
            Rectangle { x: 135px; y: 20px; width: 2px; height: 20px; background: white; }  

            // Body Parts
            if (mistakes > 0) : Rectangle { x: 125px; y: 40px; width: 22px; height: 22px; border-radius: 11px; border-width: 2px; border-color: white; }
            if (mistakes > 1) : Rectangle { x: 135px; y: 62px; width: 2px; height: 50px; background: white; }
            if (mistakes > 2) : Rectangle { x: 115px; y: 75px; width: 20px; height: 2px; background: white; }
            if (mistakes > 3) : Rectangle { x: 137px; y: 75px; width: 20px; height: 2px; background: white; }
            if (mistakes > 4) : Path { commands: "M 135 112 L 120 140"; stroke: white; stroke-width: 2px; }
            if (mistakes > 5) : Path { commands: "M 137 112 L 152 140"; stroke: white; stroke-width: 2px; }
        }

        Text {
            text: display_word;
            font-size: 32px;
            color: white;
            horizontal-alignment: center;
            letter-spacing: 5px;
        }

        Text {
            text: status_msg;
            color: game_over ? #e74c3c : #ecf0f1;
            horizontal-alignment: center;
        }

        // Letter Keyboard
        VerticalBox {
            for row in [
                ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P"],
                ["A", "S", "D", "F", "G", "H", "J", "K", "L"],
                ["Z", "X", "C", "V", "B", "N", "M"]
            ] : HorizontalBox {
                alignment: center;
                for key in row : Button {
                    text: key;
                    enabled: !game_over;
                    clicked => { root.letter_pressed(key) }
                }
            }
        }

        HorizontalBox {
            Button {
                text: "New Game";
                primary: true;
                clicked => { root.reset_game() }
            }

            Button {
                text: "Home";
                primary: true;
                clicked => { root.home_clicked() }
            }
        }
        
    }
}